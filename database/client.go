package database

import (
	"gorm.io/driver/sqlite"
	"gorm.io/gorm"
	"pentest-backend/database/models"
)

var Client *gorm.DB

func Load() {
	//Creates database connection
	db, err := gorm.Open(sqlite.Open("main.db"), &gorm.Config{})
	Client = db

	if err != nil {
		panic("failed to connect to the database")
	}

	loadModels(db)
}

//Loads in the tables
func loadModels(db *gorm.DB) {
	db.AutoMigrate(&models.User{})
	db.AutoMigrate(&models.Project{})
	db.AutoMigrate(&models.Step{})
	db.AutoMigrate(&models.Container{})
}
